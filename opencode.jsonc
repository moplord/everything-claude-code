{
  // Project-level OpenCode config.
  // Docs: https://opencode.ai/docs

  "$schema": "https://opencode.ai/config.json",

  // Prefer repository-local instructions.
  "instructions": ["AGENTS.md", ".opencode/rules/*.md"],

  // Ensure OpenCode finds project-local skills even if defaults change.
  "skills": {
    "paths": [".opencode/skills"]
  },

  // Permissions: emulate Codex-style safety posture:
  // - Allow normal local file reads/edits (with .env denied)
  // - Allow a small set of read-only shell commands without prompting
  // - Ask for most shell commands, and deny obviously destructive ones
  "permission": {
    "*": "allow",
    "read": {
      "*": "allow",
      "*.env": "deny",
      "*.env.*": "deny",
      "*.env.example": "allow"
    },
    "edit": "allow",
    "bash": {
      "*": "ask",

      // Allow conservative, read-only local commands (mirrors .codex/rules/20-allow-safe-read.rules)
      "git status*": "allow",
      "git diff*": "allow",
      "git log*": "allow",
      "git show*": "allow",
      "git blame*": "allow",
      "git rev-parse*": "allow",
      "git ls-files*": "allow",
      "rg*": "allow",

      // Deny obviously destructive operations (mirrors .codex/rules/00-safety.rules forbidden)
      "dd*": "deny",
      "mkfs*": "deny",
      "mkfs.*": "deny",
      "diskpart*": "deny",
      "format *": "deny",
      "shutdown*": "deny",
      "reboot*": "deny",
      "poweroff*": "deny",
      "rm -rf /": "deny",
      "rm -rf /*": "deny",
      "rm -rf ~": "deny",
      "rm -rf ~*": "deny",

      // Destructive-but-recoverable operations should still prompt (mirrors .codex/rules/00-safety.rules prompt)
      "git reset --hard*": "ask",
      "git clean -fdx*": "ask",
      "git branch -d *": "ask",
      "git branch -D *": "ask",

      // Network/remote state ops prompt (mirrors .codex/rules/10-prompt-remote.rules)
      "git push*": "ask",
      "git fetch*": "ask",
      "git pull*": "ask",
      "git clone*": "ask",
      "git submodule update*": "ask",
      "git submodule sync*": "ask",
      "npm*": "ask",
      "pnpm*": "ask",
      "yarn*": "ask",
      "pip*": "ask",
      "pip3*": "ask",
      "poetry*": "ask",
      "mvn*": "ask",
      "mvnw*": "ask",
      "gradle*": "ask",
      "gradlew*": "ask",
      "docker login*": "ask",
      "docker logout*": "ask",
      "docker pull*": "ask",
      "docker push*": "ask",
      "kubectl*": "ask",
      "helm*": "ask",
      "gh*": "ask",
      "glab*": "ask"
    }
  },

  // Optional MCP server definitions (placeholders; configure secrets via env vars).
  // You can also put these in your global OpenCode config and omit them here.
  "mcp": {
    "semgrep": {
      "type": "remote",
      "url": "https://mcp.semgrep.ai/mcp",
      "enabled": false
    },
    "context7": {
      "type": "remote",
      "url": "https://mcp.context7.com/mcp",
      "enabled": false,
      "headers": {
        "CONTEXT7_API_KEY": "{env:CONTEXT7_API_KEY}"
      }
    },
    "chrome-devtools": {
      "type": "local",
      "enabled": false,
      "timeout": 60000,
      "command": ["cmd", "/c", "npx", "-y", "chrome-devtools-mcp@latest"],
      "environment": {
        "SystemRoot": "C:\\\\Windows",
        "PROGRAMFILES": "C:\\\\Program Files"
      }
    },
    "ppt": {
      "type": "local",
      "enabled": false,
      "timeout": 60000,
      "command": [
        "{env:PPT_MCP_PYTHON}",
        "{env:PPT_MCP_SERVER}"
      ],
      "environment": {}
    },

    // Migrated from legacy/claude-code/mcp-configs/mcp-servers.json
    "github": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@modelcontextprotocol/server-github"],
      "environment": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "{env:GITHUB_PERSONAL_ACCESS_TOKEN}"
      }
    },
    "firecrawl": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "firecrawl-mcp"],
      "environment": {
        "FIRECRAWL_API_KEY": "{env:FIRECRAWL_API_KEY}"
      }
    },
    "supabase": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@supabase/mcp-server-supabase@latest", "--project-ref=YOUR_PROJECT_REF"]
    },
    "memory": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@modelcontextprotocol/server-memory"]
    },
    "sequential-thinking": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@modelcontextprotocol/server-sequential-thinking"]
    },
    "vercel": {
      "type": "remote",
      "enabled": false,
      "url": "https://mcp.vercel.com"
    },
    "railway": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@railway/mcp-server"]
    },
    "cloudflare-docs": {
      "type": "remote",
      "enabled": false,
      "url": "https://docs.mcp.cloudflare.com/mcp"
    },
    "cloudflare-workers-builds": {
      "type": "remote",
      "enabled": false,
      "url": "https://builds.mcp.cloudflare.com/mcp"
    },
    "cloudflare-workers-bindings": {
      "type": "remote",
      "enabled": false,
      "url": "https://bindings.mcp.cloudflare.com/mcp"
    },
    "cloudflare-observability": {
      "type": "remote",
      "enabled": false,
      "url": "https://observability.mcp.cloudflare.com/mcp"
    },
    "clickhouse": {
      "type": "remote",
      "enabled": false,
      "url": "https://mcp.clickhouse.cloud/mcp"
    },
    "context7-npx": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@context7/mcp-server"]
    },
    "magic": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@magicuidesign/mcp@latest"]
    },
    "filesystem": {
      "type": "local",
      "enabled": false,
      "command": ["npx", "-y", "@modelcontextprotocol/server-filesystem", "/path/to/your/projects"]
    }
  }
}
